<!DOCTYPE html>
<html>
<head>
<title>폴더 이름 가져오기</title>
<style>
body { font-family: sans-serif; }
table { width: 100%; border-collapse: collapse; }
th, td { border: 1px solid #ccc; padding: 8px; text-align: left; }
th { 
 text-align: center; 
 background-color: rgb(210, 229, 155); 
 border: 1px solid black; 
}
.title-container {
 display: flex;
 justify-content: center;
 background-color: rgba(165, 192, 224, 0.954);
}
h1 {
 color: black;
 margin-bottom: 20px;
 font-size: 32px;
}

.folder-selection {
 display: flex;
 align-items: center;
 gap: 20px;
 margin: 20px 0;
}
input[type="file"] {
 font-size: 14px;
}
.folder-selection p {
 margin: 0;
 font-size: 16px;
}
</style>
</head>
<body>

<div class="title-container">
 <h1>Creo 파일이 있는 폴더 이름 가져오기</h1>
</div>

<div class="folder-selection">
 <input type="file" id="folderInput" webkitdirectory onchange="chooseFolder()">
 <p>전체 폴더 개수: <span id="totalFolders">0</span></p>
 <p style="margin-left: 100px;">선택한 폴더 이름: <span id="selectedFolderName"></span></p>
</div>

<table>
<thead>
<tr>
<th>번호</th>
<th>폴더 이름</th>
<th>레벨</th>
<th>생성 날짜</th>
</tr>
</thead>
<tbody id="folderTable">
</tbody>
</table>

<script>
function chooseFolder() {
 const input = document.getElementById('folderInput');
 const files = input.files;
 const folders = new Map();
 const creoExtensions = ['.asm', '.prt', '.drw'];

 for (let i = 0; i < files.length; i++) {
  const file = files[i];
  const pathParts = file.webkitRelativePath.split('/');
  const folderName = pathParts.slice(0, -1).join('/');
  const level = pathParts.length - 1; // 폴더 계층 레벨
  const created = new Date(file.lastModified).toLocaleDateString();

  // Creo 파일 확장자 확인
  if (creoExtensions.some(ext => file.name.match(new RegExp(ext + "\\.\\d+$")))) {
   if (!folders.has(folderName)) {
    folders.set(folderName, { name: folderName, level: level, created: created });
   }
  }
 }

 displayFolders(Array.from(folders.values()));
}

function displayFolders(folders) {
 const totalFolders = folders.length;
 document.getElementById("totalFolders").textContent = totalFolders;

 if (totalFolders > 0) {
  const selectedFolderName = folders[0].name;
  document.getElementById("selectedFolderName").textContent = selectedFolderName;
 }

 const tableBody = document.getElementById("folderTable");
 tableBody.innerHTML = ""; // 기존 내용 지우기

 folders.forEach((folder, index) => {
  const row = tableBody.insertRow();
  let cell = row.insertCell();
  cell.textContent = index + 1; // 번호 매기기
  cell.style.textAlign = "center"; 

  row.insertCell().textContent = folder.name;

  cell = row.insertCell(); 
  cell.textContent = folder.level;
  cell.style.textAlign = "center"; 

  cell = row.insertCell();
  cell.textContent = folder.created; // Windows 파일 수정 날짜 반영
  cell.style.textAlign = "right"; 
 });
}
</script>

</body>
</html>
